using System;
using System.Diagnostics;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Text;
using System.Windows.Forms;
using System.ComponentModel;

namespace Utils {
    public class IconButton : PictureBox {
		// TODO: introduce IconType class
        // private IconType _iconType = FontAwesome.Star;

		private FontAwesome _iconType = FontAwesome.Star;
        private string _tooltip = null;
        private Color _activeColor = Color.Black;
        private Color _inActiveColor = Color.Black;
        private ToolTip _tT = new ToolTip();
        private string IconChar { get; set; }
        private Font IconFont { get; set; }
        private Brush IconBrush { get; set; } 
        private Brush ActiveBrush { get; set; } 
        private Brush InActiveBrush { get; set; }

        public IconButton() : this(FontAwesome.Star, 16, Color.DimGray, Color.Black, false, null) { }

        public IconButton(FontAwesome type, int size, Color normalColor, Color hoverColor, bool selectable, string toolTip) {
            IconFont = null;
            BackColor = Color.Transparent;

            // need more than this to make picturebox selectable
            if (selectable) {
                SetStyle(ControlStyles.Selectable, true);
                TabStop = true;
            }

            Width = size;
            Height = size;

            IconType = type;

            InActiveColor = normalColor;
            ActiveColor = hoverColor;

            ToolTipText = toolTip;

            MouseEnter += Icon_MouseEnter;
            MouseLeave += Icon_MouseLeave;
        }

        public FontAwesome IconType {
            get { return _iconType; }
            set {
                _iconType = value;
                // see http://fortawesome.github.io/Font-Awesome/cheatsheet/ for a list of hex values
                IconChar = char.ConvertFromUtf32((int)value);
                Invalidate();
            }
        }

        [Localizable(true)]
        public string ToolTipText {
            get { return _tooltip; }
            set {
                _tooltip = value;
                if (value != null) {
                    _tT.IsBalloon = true;
                    _tT.ShowAlways = true;
                    _tT.SetToolTip(this, value);
                }
            }
        }

        public Color ActiveColor {
            get { return _activeColor; }
            set {
                _activeColor = value;
                ActiveBrush = new SolidBrush(value);
                Invalidate();
            }
        }

        public Color InActiveColor {
            get { return _inActiveColor; }
            set {
                _inActiveColor = value;
                InActiveBrush = new SolidBrush(value);
                IconBrush = InActiveBrush;
                Invalidate();
            }
        }

        public new int Width {
            set {
                // force the font size to be recalculated & redrawn
                base.Width = value;
                IconFont = null;
                Invalidate();
            }
            get { return base.Width; }
        }

        public new int Height {
            set {
                // force the font size to be recalculated & redrawn
                base.Height = value;
                IconFont = null;
                Invalidate();
            }
            get { return base.Height; }
        }

        public void SetIconChar(char value) {
            IconChar = value.ToString();
            Invalidate();
        }

        public void SetIconChar(String value) {
            IconChar = value;
            Invalidate();
        }
        protected void Icon_MouseLeave(object sender, EventArgs e) {
            // change the brush and force a redraw
            IconBrush = InActiveBrush;
            Invalidate();
        }
        protected void Icon_MouseEnter(object sender, EventArgs e) {
            // change the brush and force a redraw
            IconBrush = ActiveBrush;
            Invalidate();
        }
        protected override void OnPaint(PaintEventArgs e) {
            var graphics = e.Graphics;

            // Set best quality
            graphics.TextRenderingHint = TextRenderingHint.AntiAliasGridFit;
            graphics.InterpolationMode = InterpolationMode.HighQualityBilinear;
            graphics.PixelOffsetMode = PixelOffsetMode.HighQuality;
            graphics.SmoothingMode = SmoothingMode.HighQuality;

            if (IconFont == null) {
                SetFontSize(graphics);
            }

            // center the icon
            SizeF stringSize = graphics.MeasureString(IconChar, IconFont, Width);
            float w = stringSize.Width;
            float h = stringSize.Height;

            float left = (Width - w) / 2;
            float top = (Height - h) / 2;

            graphics.DrawString(IconChar, IconFont, IconBrush, new PointF(left, top));

            base.OnPaint(e);

            if (Focused) {
                var rc = this.ClientRectangle;
                rc.Inflate(-2, -2);
                ControlPaint.DrawFocusRectangle(e.Graphics, rc);
            }
        }

        private void SetFontSize(Graphics g) {
            IconFont = GetAdjustedFont(g, IconChar, Width, Height, 4, true);
        }

        private Font GetIconFont(float size) {
        	// Console.Error.WriteLine(Fonts.Families.Length);
            return new Font(Fonts.Families[0], size, GraphicsUnit.Point);
        }

		private Font GetAdjustedFont(Graphics g, string graphicString, int containerWidth, int maxFontSize, int minFontSize, bool smallestOnFail) {
			for (double adjustedSize = maxFontSize; adjustedSize >= minFontSize; adjustedSize = adjustedSize - 0.5) {
				Font testFont = GetIconFont((float)adjustedSize);
				SizeF adjustedSizeNew = g.MeasureString(graphicString, testFont);
				if (containerWidth > Convert.ToInt32(adjustedSizeNew.Width)) {
					return testFont;
				}
			}
			return GetIconFont(smallestOnFail ? minFontSize : maxFontSize);
		}

        static IconButton() {
            InitialiseFont();
        }

        [System.Runtime.InteropServices.DllImport("gdi32.dll")]
        private static extern IntPtr AddFontMemResourceEx(IntPtr pbFont, uint cbFont,
           IntPtr pdv, [System.Runtime.InteropServices.In] ref uint pcFonts);

        private static readonly PrivateFontCollection Fonts = new PrivateFontCollection();

        private static void InitialiseFont() {
            try {
                unsafe {
                    // fixed (byte* pFontData = Properties.Resources.fontawesome_webfont) {
        			fixed ( byte* pFontData = data) {
                    	
                        uint dummy = 0;
                        Fonts.AddMemoryFont((IntPtr)pFontData, data.Length);
                        AddFontMemResourceEx((IntPtr)pFontData, (uint)data.Length, IntPtr.Zero, ref dummy);
                    }
                }
            } catch (Exception e) {
				Trace.Assert(e != null);
            }

        }
        	// NOTE:  Error CS0134: 'Utils.IconButton.data' is of type 'byte[]'. A const field of a reference type other than string can only be initialized with null			
		private static /* const */ byte[] data = new byte[] {
			0x00,
			0x01,  0x00,  0x00,  0x00,  0x0D,  0x00,  0x80,  0x00,  0x03,  0x00,  0x50,  0x46,  0x46,  0x54,  0x4D,  0x86,
			0xCA,  0x02,  0xA0,  0x00,  0x00,  0x08,  0x20,  0x00,  0x00,  0x00,  0x1C,  0x4F,  0x53,  0x2F,  0x32,  0x4F,
			0xF6,  0x5C,  0xD4,  0x00,  0x00,  0x01,  0x58,  0x00,  0x00,  0x00,  0x60,  0x63,  0x6D,  0x61,  0x70,  0xE1,
			0xF6,  0x15,  0xFF,  0x00,  0x00,  0x01,  0xD0,  0x00,  0x00,  0x01,  0x4A,  0x63,  0x76,  0x74,  0x20,  0x00,
			0x11,  0x01,  0x44,  0x00,  0x00,  0x03,  0x1C,  0x00,  0x00,  0x00,  0x04,  0x67,  0x61,  0x73,  0x70,  0xFF,
			0xFF,  0x00,  0x03,  0x00,  0x00,  0x08,  0x18,  0x00,  0x00,  0x00,  0x08,  0x67,  0x6C,  0x79,  0x66,  0xA2,
			0x30,  0xF7,  0x4B,  0x00,  0x00,  0x03,  0x30,  0x00,  0x00,  0x02,  0xD8,  0x68,  0x65,  0x61,  0x64,  0x12,
			0x44,  0x1C,  0x14,  0x00,  0x00,  0x00,  0xDC,  0x00,  0x00,  0x00,  0x36,  0x68,  0x68,  0x65,  0x61,  0x03,
			0xEF,  0x01,  0xC6,  0x00,  0x00,  0x01,  0x14,  0x00,  0x00,  0x00,  0x24,  0x68,  0x6D,  0x74,  0x78,  0x04,
			0x2D,  0x00,  0x36,  0x00,  0x00,  0x01,  0xB8,  0x00,  0x00,  0x00,  0x18,  0x6C,  0x6F,  0x63,  0x61,  0x01,
			0x82,  0x02,  0x92,  0x00,  0x00,  0x03,  0x20,  0x00,  0x00,  0x00,  0x10,  0x6D,  0x61,  0x78,  0x70,  0x00,
			0x4F,  0x00,  0xA4,  0x00,  0x00,  0x01,  0x38,  0x00,  0x00,  0x00,  0x20,  0x6E,  0x61,  0x6D,  0x65,  0xF3,
			0x85,  0xDA,  0x2C,  0x00,  0x00,  0x06,  0x08,  0x00,  0x00,  0x01,  0xBC,  0x70,  0x6F,  0x73,  0x74,  0xA6,
			0x46,  0x13,  0x7E,  0x00,  0x00,  0x07,  0xC4,  0x00,  0x00,  0x00,  0x53,  0x00,  0x01,  0x00,  0x00,  0x00,
			0x01,  0x00,  0x00,  0x72,  0x8E,  0x40,  0x61,  0x5F,  0x0F,  0x3C,  0xF5,  0x00,  0x0B,  0x02,  0x00,  0x00,
			0x00,  0x00,  0x00,  0xD8,  0x92,  0xED,  0xCB,  0x00,  0x00,  0x00,  0x00,  0xD8,  0x92,  0xED,  0xCC,  0xFF,
			0xFF,  0xFF,  0xC0,  0x02,  0x00,  0x01,  0xC0,  0x00,  0x00,  0x00,  0x08,  0x00,  0x02,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x01,  0x00,  0x00,  0x01,  0xC0,  0xFF,  0xC0,  0x00,  0x2E,  0x02,  0x00,  0xFF,
			0xFF,  0x00,  0x00,  0x02,  0x00,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x05,  0x00,  0x01,  0x00,  0x00,  0x00,  0x07,  0x00,  0x73,  0x00,
			0x06,  0x00,  0x00,  0x00,  0x00,  0x00,  0x02,  0x00,  0x00,  0x00,  0x01,  0x00,  0x01,  0x00,  0x00,  0x00,
			0x40,  0x00,  0x2E,  0x00,  0x00,  0x00,  0x00,  0x00,  0x04,  0x01,  0xB2,  0x01,  0x90,  0x00,  0x05,  0x00,
			0x00,  0x01,  0x4C,  0x01,  0x66,  0x00,  0x00,  0x00,  0x47,  0x01,  0x4C,  0x01,  0x66,  0x00,  0x00,  0x00,
			0xF5,  0x00,  0x19,  0x00,  0x84,  0x00,  0x00,  0x02,  0x00,  0x05,  0x03,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x01,  0x10,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x50,  0x66,  0x45,  0x64,  0x00,  0x80,  0x00,  0x20,  0xF1,  0x02,  0x01,  0xC0,  0xFF,  0xC0,  0x00,
			0x2E,  0x01,  0xC0,  0x00,  0x40,  0x00,  0x00,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x20,  0x00,  0x01,  0x00,  0xBB,  0x00,  0x11,  0x00,  0x00,  0x00,  0x00,  0x00,
			0xAA,  0x00,  0x00,  0x00,  0xC8,  0x00,  0x00,  0x02,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x25,  0x00,
			0x00,  0x00,  0x03,  0x00,  0x00,  0x00,  0x03,  0x00,  0x00,  0x00,  0x1C,  0x00,  0x01,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x44,  0x00,  0x03,  0x00,  0x01,  0x00,  0x00,  0x00,  0x1C,  0x00,  0x04,  0x00,  0x28,  0x00,
			0x00,  0x00,  0x06,  0x00,  0x04,  0x00,  0x01,  0x00,  0x02,  0x00,  0x20,  0xF1,  0x02,  0xFF,  0xFF,  0x00,
			0x00,  0x00,  0x20,  0xF1,  0x00,  0xFF,  0xFF,  0xFF,  0xE3,  0x0F,  0x04,  0x00,  0x01,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x01,  0x06,  0x00,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x01,  0x02,  0x00,  0x00,  0x00,  0x02,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x01,  0x00,  0x00,  0x03,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x11,  0x01,  0x44,  0x00,
			0x00,  0x00,  0x2A,  0x00,  0x2A,  0x00,  0x2A,  0x00,  0x2A,  0x00,  0xD2,  0x01,  0x2E,  0x01,  0x6C,  0x00,
			0x02,  0x00,  0x11,  0x00,  0x00,  0x00,  0x99,  0x01,  0x55,  0x00,  0x03,  0x00,  0x07,  0x00,  0x2E,  0xB1,
			0x01,  0x00,  0x2F,  0x3C,  0xB2,  0x07,  0x04,  0x00,  0xED,  0x32,  0xB1,  0x06,  0x05,  0xDC,  0x3C,  0xB2,
			0x03,  0x02,  0x00,  0xED,  0x32,  0x00,  0xB1,  0x03,  0x00,  0x2F,  0x3C,  0xB2,  0x05,  0x04,  0x00,  0xED,
			0x32,  0xB2,  0x07,  0x06,  0x01,  0xFC,  0x3C,  0xB2,  0x01,  0x02,  0x00,  0xED,  0x32,  0x33,  0x11,  0x33,
			0x11,  0x27,  0x33,  0x11,  0x23,  0x11,  0x88,  0x77,  0x66,  0x66,  0x01,  0x55,  0xFE,  0xAB,  0x11,  0x01,
			0x33,  0x00,  0x00,  0x00,  0x06,  0xFF,  0xFF,  0xFF,  0xE3,  0x02,  0x00,  0x01,  0x9D,  0x00,  0x03,  0x00,
			0x07,  0x00,  0x49,  0x00,  0x50,  0x00,  0x58,  0x00,  0x72,  0x00,  0x00,  0x00,  0x34,  0x32,  0x14,  0x26,
			0x34,  0x32,  0x14,  0x1F,  0x01,  0x16,  0x07,  0x06,  0x22,  0x2F,  0x01,  0x06,  0x23,  0x22,  0x23,  0x06,
			0x31,  0x07,  0x06,  0x23,  0x22,  0x2F,  0x01,  0x07,  0x06,  0x22,  0x26,  0x34,  0x3F,  0x01,  0x36,  0x34,
			0x26,  0x22,  0x0F,  0x01,  0x27,  0x37,  0x36,  0x32,  0x16,  0x14,  0x0F,  0x01,  0x06,  0x14,  0x16,  0x32,
			0x3F,  0x01,  0x27,  0x26,  0x3F,  0x01,  0x34,  0x35,  0x34,  0x37,  0x27,  0x26,  0x36,  0x1F,  0x01,  0x36,
			0x33,  0x32,  0x16,  0x15,  0x14,  0x01,  0x37,  0x2E,  0x01,  0x27,  0x07,  0x17,  0x3F,  0x01,  0x2E,  0x01,
			0x27,  0x07,  0x1E,  0x01,  0x37,  0x32,  0x37,  0x27,  0x26,  0x36,  0x1F,  0x01,  0x36,  0x35,  0x34,  0x26,
			0x23,  0x22,  0x07,  0x17,  0x16,  0x07,  0x06,  0x22,  0x2F,  0x01,  0x06,  0x15,  0x14,  0x16,  0x01,  0xC8,
			0x10,  0x10,  0x10,  0x0E,  0x02,  0x06,  0x06,  0x02,  0x07,  0x02,  0x02,  0x1E,  0x27,  0x05,  0x05,  0x24,
			0xD9,  0x03,  0x03,  0x03,  0x03,  0x17,  0x04,  0x12,  0x32,  0x24,  0x12,  0x99,  0x0D,  0x1A,  0x25,  0x0D,
			0x5E,  0x0C,  0x5F,  0x12,  0x32,  0x24,  0x12,  0x9A,  0x0D,  0x1A,  0x25,  0x0D,  0x05,  0x17,  0x06,  0x05,
			0xE3,  0x19,  0x02,  0x06,  0x0B,  0x06,  0x02,  0x1E,  0x28,  0x2C,  0x3E,  0xFE,  0x89,  0xCB,  0x17,  0x23,
			0x0B,  0xB4,  0x17,  0xEF,  0x17,  0x1A,  0x27,  0x07,  0x15,  0x0A,  0x25,  0x4C,  0x20,  0x19,  0x56,  0x06,
			0x0C,  0x05,  0x57,  0x15,  0x35,  0x25,  0x21,  0x19,  0x11,  0x06,  0x06,  0x02,  0x07,  0x02,  0x11,  0x15,
			0x35,  0x01,  0x1E,  0x10,  0x10,  0x2E,  0x10,  0x10,  0x5F,  0x02,  0x06,  0x06,  0x02,  0x02,  0x02,  0x19,
			0x20,  0xC2,  0x02,  0x02,  0x17,  0x05,  0x11,  0x23,  0x33,  0x11,  0x9A,  0x0D,  0x25,  0x19,  0x0C,  0x5F,
			0x0C,  0x5E,  0x12,  0x24,  0x32,  0x12,  0x99,  0x0D,  0x25,  0x1A,  0x0D,  0x05,  0x17,  0x05,  0x06,  0xFD,
			0x05,  0x05,  0x27,  0x1E,  0x02,  0x06,  0x0C,  0x06,  0x02,  0x19,  0x3E,  0x2C,  0x27,  0xFE,  0xEC,  0xB5,
			0x0B,  0x23,  0x16,  0xCA,  0x18,  0xAA,  0x14,  0x08,  0x26,  0x1A,  0x17,  0x17,  0x24,  0x16,  0x15,  0x57,
			0x05,  0x0C,  0x06,  0x57,  0x19,  0x21,  0x25,  0x35,  0x15,  0x11,  0x06,  0x05,  0x03,  0x03,  0x11,  0x19,
			0x21,  0x25,  0x35,  0x00,  0x05,  0x00,  0x00,  0xFF,  0xC0,  0x02,  0x00,  0x01,  0xC0,  0x00,  0x1C,  0x00,
			0x26,  0x00,  0x30,  0x00,  0x38,  0x00,  0x41,  0x00,  0x00,  0x01,  0x33,  0x0E,  0x04,  0x07,  0x14,  0x06,
			0x23,  0x15,  0x33,  0x15,  0x23,  0x35,  0x33,  0x35,  0x22,  0x26,  0x35,  0x2E,  0x03,  0x2F,  0x01,  0x33,
			0x21,  0x05,  0x35,  0x23,  0x14,  0x1E,  0x05,  0x05,  0x35,  0x21,  0x15,  0x14,  0x16,  0x3B,  0x01,  0x32,
			0x36,  0x37,  0x3E,  0x03,  0x3F,  0x01,  0x23,  0x03,  0x35,  0x23,  0x35,  0x32,  0x36,  0x35,  0x33,  0x15,
			0x01,  0x9E,  0x62,  0x01,  0x02,  0x0E,  0x13,  0x26,  0x18,  0x55,  0x3D,  0x62,  0xDC,  0x62,  0x3D,  0x55,
			0x18,  0x26,  0x14,  0x0C,  0x02,  0x02,  0x62,  0x01,  0x30,  0xFE,  0xD0,  0x47,  0x01,  0x06,  0x06,  0x0C,
			0x0E,  0x14,  0x01,  0x30,  0xFE,  0xF4,  0x47,  0x33,  0x18,  0x33,  0x47,  0x18,  0x10,  0x1A,  0x0F,  0x0A,
			0x02,  0x02,  0x47,  0xAA,  0x31,  0x1D,  0x14,  0x18,  0x01,  0xC0,  0x07,  0x1A,  0x43,  0x37,  0x36,  0x0A,
			0x3D,  0x56,  0x7A,  0x18,  0x18,  0x7A,  0x56,  0x3D,  0x0A,  0x35,  0x3C,  0x3A,  0x13,  0x13,  0xC1,  0xA9,
			0x03,  0x09,  0x1C,  0x1B,  0x24,  0x1D,  0x1C,  0x23,  0xC3,  0xC3,  0x34,  0x46,  0x46,  0x4E,  0x0C,  0x2B,
			0x2D,  0x2A,  0x0D,  0x0E,  0xFE,  0xF3,  0x93,  0x18,  0x1A,  0x17,  0xDC,  0x00,  0x03,  0x00,  0x25,  0xFF,
			0xC0,  0x01,  0xDB,  0x01,  0xC0,  0x00,  0x15,  0x00,  0x20,  0x00,  0x28,  0x00,  0x00,  0x25,  0x06,  0x07,
			0x15,  0x33,  0x15,  0x23,  0x35,  0x33,  0x35,  0x26,  0x27,  0x26,  0x34,  0x37,  0x17,  0x06,  0x14,  0x17,
			0x16,  0x32,  0x37,  0x07,  0x22,  0x26,  0x34,  0x36,  0x32,  0x16,  0x15,  0x14,  0x0E,  0x01,  0x12,  0x22,
			0x06,  0x14,  0x16,  0x32,  0x36,  0x34,  0x01,  0xC2,  0x43,  0x5E,  0x3B,  0x8C,  0x3C,  0x5E,  0x42,  0x47,
			0x47,  0x0F,  0x40,  0x40,  0x40,  0xB7,  0x41,  0x9C,  0x51,  0x73,  0x73,  0xA2,  0x73,  0x35,  0x5A,  0x13,
			0x90,  0x67,  0x67,  0x90,  0x66,  0x51,  0x43,  0x04,  0x34,  0x16,  0x16,  0x34,  0x04,  0x43,  0x46,  0xC9,
			0x47,  0x0F,  0x41,  0xB6,  0x41,  0x40,  0x40,  0x28,  0x73,  0xA2,  0x73,  0x73,  0x51,  0x35,  0x5B,  0x34,
			0x01,  0x72,  0x66,  0x90,  0x66,  0x66,  0x90,  0x00,  0x00,  0x00,  0x0E,  0x00,  0xAE,  0x00,  0x01,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x02,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x01,  0x00,  0x08,  0x00,  0x15,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,  0x02,  0x00,  0x07,  0x00,
			0x2E,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,  0x03,  0x00,  0x24,  0x00,  0x80,  0x00,  0x01,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x04,  0x00,  0x08,  0x00,  0xB7,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x05,  0x00,  0x10,  0x00,  0xE2,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0x00,  0x06,  0x00,  0x08,  0x01,
			0x05,  0x00,  0x03,  0x00,  0x01,  0x04,  0x09,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x03,  0x00,
			0x01,  0x04,  0x09,  0x00,  0x01,  0x00,  0x10,  0x00,  0x03,  0x00,  0x03,  0x00,  0x01,  0x04,  0x09,  0x00,
			0x02,  0x00,  0x0E,  0x00,  0x1E,  0x00,  0x03,  0x00,  0x01,  0x04,  0x09,  0x00,  0x03,  0x00,  0x48,  0x00,
			0x36,  0x00,  0x03,  0x00,  0x01,  0x04,  0x09,  0x00,  0x04,  0x00,  0x10,  0x00,  0xA5,  0x00,  0x03,  0x00,
			0x01,  0x04,  0x09,  0x00,  0x05,  0x00,  0x20,  0x00,  0xC0,  0x00,  0x03,  0x00,  0x01,  0x04,  0x09,  0x00,
			0x06,  0x00,  0x10,  0x00,  0xF3,  0x00,  0x00,  0x00,  0x00,  0x46,  0x00,  0x6C,  0x00,  0x61,  0x00,  0x74,
			0x00,  0x69,  0x00,  0x63,  0x00,  0x6F,  0x00,  0x6E,  0x00,  0x00,  0x46,  0x6C,  0x61,  0x74,  0x69,  0x63,
			0x6F,  0x6E,  0x00,  0x00,  0x52,  0x00,  0x65,  0x00,  0x67,  0x00,  0x75,  0x00,  0x6C,  0x00,  0x61,  0x00,
			0x72,  0x00,  0x00,  0x52,  0x65,  0x67,  0x75,  0x6C,  0x61,  0x72,  0x00,  0x00,  0x46,  0x00,  0x6F,  0x00,
			0x6E,  0x00,  0x74,  0x00,  0x46,  0x00,  0x6F,  0x00,  0x72,  0x00,  0x67,  0x00,  0x65,  0x00,  0x20,  0x00,
			0x32,  0x00,  0x2E,  0x00,  0x30,  0x00,  0x20,  0x00,  0x3A,  0x00,  0x20,  0x00,  0x46,  0x00,  0x6C,  0x00,
			0x61,  0x00,  0x74,  0x00,  0x69,  0x00,  0x63,  0x00,  0x6F,  0x00,  0x6E,  0x00,  0x20,  0x00,  0x3A,  0x00,
			0x20,  0x00,  0x32,  0x00,  0x30,  0x00,  0x2D,  0x00,  0x32,  0x00,  0x2D,  0x00,  0x32,  0x00,  0x30,  0x00,
			0x31,  0x00,  0x39,  0x00,  0x00,  0x46,  0x6F,  0x6E,  0x74,  0x46,  0x6F,  0x72,  0x67,  0x65,  0x20,  0x32,
			0x2E,  0x30,  0x20,  0x3A,  0x20,  0x46,  0x6C,  0x61,  0x74,  0x69,  0x63,  0x6F,  0x6E,  0x20,  0x3A,  0x20,
			0x32,  0x30,  0x2D,  0x32,  0x2D,  0x32,  0x30,  0x31,  0x39,  0x00,  0x00,  0x46,  0x00,  0x6C,  0x00,  0x61,
			0x00,  0x74,  0x00,  0x69,  0x00,  0x63,  0x00,  0x6F,  0x00,  0x6E,  0x00,  0x00,  0x46,  0x6C,  0x61,  0x74,
			0x69,  0x63,  0x6F,  0x6E,  0x00,  0x00,  0x56,  0x00,  0x65,  0x00,  0x72,  0x00,  0x73,  0x00,  0x69,  0x00,
			0x6F,  0x00,  0x6E,  0x00,  0x20,  0x00,  0x30,  0x00,  0x30,  0x00,  0x31,  0x00,  0x2E,  0x00,  0x30,  0x00,
			0x30,  0x00,  0x30,  0x00,  0x20,  0x00,  0x00,  0x56,  0x65,  0x72,  0x73,  0x69,  0x6F,  0x6E,  0x20,  0x30,
			0x30,  0x31,  0x2E,  0x30,  0x30,  0x30,  0x20,  0x00,  0x00,  0x46,  0x00,  0x6C,  0x00,  0x61,  0x00,  0x74,
			0x00,  0x69,  0x00,  0x63,  0x00,  0x6F,  0x00,  0x6E,  0x00,  0x00,  0x46,  0x6C,  0x61,  0x74,  0x69,  0x63,
			0x6F,  0x6E,  0x00,  0x00,  0x02,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0xFF,  0xC0,  0x00,  0x19,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,  0x00,
			0x00,  0x00,  0x00,  0x00,  0x07,  0x00,  0x00,  0x00,  0x01,  0x00,  0x02,  0x00,  0x03,  0x01,  0x02,  0x01,
			0x03,  0x01,  0x04,  0x08,  0x30,  0x30,  0x31,  0x2D,  0x73,  0x69,  0x6E,  0x67,  0x09,  0x30,  0x30,  0x32,
			0x2D,  0x70,  0x72,  0x69,  0x7A,  0x65,  0x0F,  0x30,  0x30,  0x33,  0x2D,  0x65,  0x61,  0x72,  0x74,  0x68,
			0x2D,  0x67,  0x6C,  0x6F,  0x62,  0x65,  0x00,  0x00,  0x00,  0x00,  0x01,  0xFF,  0xFF,  0x00,  0x02,  0x00,
			0x00,  0x00,  0x01,  0x00,  0x00,  0x00,  0x00,  0xD5,  0xA4,  0x27,  0x08,  0x00,  0x00,  0x00,  0x00,  0xD8,
			0x92,  0xED,  0xCB,  0x00,  0x00,  0x00,  0x00,  0xD8,  0x92,  0xED,  0xCC
        };

    }
}
